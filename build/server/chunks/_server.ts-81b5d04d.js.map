{"version":3,"file":"_server.ts-81b5d04d.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/nlidb/_server.ts.js"],"sourcesContent":["import { j as json } from \"../../../../chunks/index.js\";\nimport { sha256 } from \"js-sha256\";\nconst POST = async ({ request, locals }) => {\n  const body = await request.json();\n  const session = await locals.getSession();\n  if (!body || !session) {\n    return new Response(JSON.stringify({ error: \"No body\" }), { status: 400 });\n  }\n  if (!body.now || body.now > (/* @__PURE__ */ new Date()).getTime() + 1e3 * 60) {\n    return new Response(JSON.stringify({ error: \"Invalid time\" }), { status: 400 });\n  }\n  const local_hash = sha256(session.user.name + body.now.toString());\n  if (local_hash != body.hash) {\n    return new Response(JSON.stringify({ error: \"Invalid hash\" }), { status: 400 });\n  }\n  try {\n    const data = await fetch(\"http://127.0.0.1:8000/v1/nlidb\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(body)\n    });\n    const response = await data.json();\n    const status = data.status;\n    if (status != 200) {\n      return new Response(JSON.stringify(response), { status });\n    }\n    return json(response);\n  } catch (e) {\n    return new Response(JSON.stringify({ error: \"Internal error\", detail: e.toString() }), {\n      status: 500\n    });\n  }\n};\nexport {\n  POST\n};\n"],"names":[],"mappings":";;;AAEK,MAAC,IAAI,GAAG,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,KAAK;AAC5C,EAAE,MAAM,IAAI,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE,CAAC;AACpC,EAAE,MAAM,OAAO,GAAG,MAAM,MAAM,CAAC,UAAU,EAAE,CAAC;AAC5C,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC,OAAO,EAAE;AACzB,IAAI,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;AAC/E,GAAG;AACH,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,GAAG,iBAAiB,IAAI,IAAI,EAAE,EAAE,OAAO,EAAE,GAAG,GAAG,GAAG,EAAE,EAAE;AACjF,IAAI,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,EAAE,cAAc,EAAE,CAAC,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;AACpF,GAAG;AACH,EAAE,MAAM,UAAU,GAAG,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAC;AACrE,EAAE,IAAI,UAAU,IAAI,IAAI,CAAC,IAAI,EAAE;AAC/B,IAAI,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,EAAE,cAAc,EAAE,CAAC,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;AACpF,GAAG;AACH,EAAE,IAAI;AACN,IAAI,MAAM,IAAI,GAAG,MAAM,KAAK,CAAC,gCAAgC,EAAE;AAC/D,MAAM,MAAM,EAAE,MAAM;AACpB,MAAM,OAAO,EAAE;AACf,QAAQ,cAAc,EAAE,kBAAkB;AAC1C,OAAO;AACP,MAAM,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;AAChC,KAAK,CAAC,CAAC;AACP,IAAI,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,IAAI,EAAE,CAAC;AACvC,IAAI,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;AAC/B,IAAI,IAAI,MAAM,IAAI,GAAG,EAAE;AACvB,MAAM,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC;AAChE,KAAK;AACL,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,CAAC;AAC1B,GAAG,CAAC,OAAO,CAAC,EAAE;AACd,IAAI,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,EAAE,gBAAgB,EAAE,MAAM,EAAE,CAAC,CAAC,QAAQ,EAAE,EAAE,CAAC,EAAE;AAC3F,MAAM,MAAM,EAAE,GAAG;AACjB,KAAK,CAAC,CAAC;AACP,GAAG;AACH;;;;"}